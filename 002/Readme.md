It's been ages since I used C, so I was mostly just trying to see if I could do it in reasonably intelligible C

Readability is mostly what I'm trying for